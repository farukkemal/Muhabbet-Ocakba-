<!DOCTYPE html>
<html lang="tr" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Y√∂netim Paneli | Muhabbet Ocakba≈üƒ±</title>
    <meta name="robots" content="noindex, nofollow">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Playfair+Display:wght@600;700;800&display=swap"
        rel="stylesheet">

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        :root {
            --black: #000000;
            --black-card: #141414;
            --gold: #FFD700;
            --gold-dark: #B8860B;
            --white: #FFFFFF;
            --gray: #888;
            --fire-red: #D32F2F;
            --whatsapp: #25D366;
            --glass-bg: rgba(20, 20, 20, 0.8);
            --glass-border: rgba(255, 215, 0, 0.2);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--black);
            color: var(--white);
            line-height: 1.5;
            min-height: 100vh;
        }

        /* Navbar */
        .admin-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.95);
            padding: 12px 16px;
            border-bottom: 1px solid var(--glass-border);
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--gold);
        }

        .nav-brand h1 {
            font-size: 18px;
            margin: 0;
            font-weight: 700;
        }

        /* Main Context */
        .admin-main {
            padding: 100px 16px 60px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .stat-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-left: 4px solid var(--gold);
            padding: 24px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .stat-icon {
            width: 54px;
            height: 54px;
            background: rgba(255, 215, 0, 0.1);
            color: var(--gold);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        /* Tabbed Content */
        .nav-tabs {
            border-bottom: 1px solid var(--glass-border);
        }

        .nav-tabs .nav-link {
            color: var(--gray);
            border: none;
            font-weight: 600;
            padding: 12px 20px;
        }

        .nav-tabs .nav-link.active {
            color: var(--gold);
            background: transparent;
            border-bottom: 2px solid var(--gold);
        }

        .nav-tabs .nav-link:hover {
            color: var(--white);
            border: none;
        }

        /* Category Card */
        .cat-card {
            background: var(--black-card);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .cat-card-header {
            display: flex;
            align-items: center;
            padding: 18px 24px;
            background: rgba(255, 255, 255, 0.02);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .cat-title {
            flex: 1;
            font-weight: 700;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* Product List */
        .product-list {
            padding: 20px;
        }

        .product-row {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.03);
            padding: 12px 16px;
            border-radius: 12px;
            margin-bottom: 10px;
            transition: all 0.2s;
        }

        .product-row:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .product-info {
            flex: 1;
        }

        .product-name {
            font-weight: 600;
            display: block;
        }

        .product-desc {
            font-size: 12px;
            color: var(--gray);
            display: block;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 400px;
        }

        .product-price {
            font-weight: 800;
            color: var(--gold);
            min-width: 80px;
            text-align: right;
        }

        /* Buttons */
        .btn-gold {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            border: none;
            color: black;
            font-weight: 700;
            border-radius: 10px;
        }

        .btn-outline-gold {
            border: 1px solid var(--gold);
            color: var(--gold);
            background: transparent;
            font-weight: 600;
        }

        .btn-fire {
            background: var(--fire-red);
            border: none;
            color: white;
        }

        /* Multilingual Editor Modal */
        .lang-tabs {
            gap: 8px;
            margin-bottom: 20px;
        }

        .lang-tab {
            padding: 6px 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: transparent;
            color: var(--gray);
            font-size: 12px;
            font-weight: 700;
        }

        .lang-tab.active {
            background: var(--gold);
            color: black;
            border-color: var(--gold);
        }

        .form-label {
            font-size: 13px;
            font-weight: 600;
            color: var(--gray);
            text-transform: uppercase;
            margin-bottom: 6px;
        }

        .form-control {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            border-radius: 10px;
            padding: 10px 14px;
        }

        .form-control:focus {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--gold);
            color: white;
            box-shadow: none;
        }

        /* Login Screen */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .login-card {
            background: var(--black-card);
            border: 1px solid var(--glass-border);
            padding: 40px;
            border-radius: 24px;
            width: 100%;
            max-width: 420px;
        }

        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 2000;
        }

        .toast {
            background: var(--black-card);
            border: 1px solid var(--gold);
            color: white;
            border-radius: 12px;
        }
    </style>
</head>

<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <div class="text-center mb-4">
                <img src="images/logo.png" alt="Muhabbet" style="height: 60px;">
            </div>
            <h2 class="text-center mb-4" style="color: var(--gold); font-family: 'Playfair Display';">Y√∂netim Giri≈üi
            </h2>
            <form id="loginForm">
                <div class="mb-4">
                    <label class="form-label">≈ûƒ∞FRE</label>
                    <input type="password" class="form-control text-center" id="passwordInput" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                        required>
                </div>
                <button type="submit" class="btn btn-gold w-100 py-3">Gƒ∞Rƒ∞≈û YAP</button>
            </form>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" style="display: none;">
        <nav class="admin-nav">
            <div class="nav-content">
                <a href="admin.html" class="nav-brand">
                    <img src="images/logo.png" alt="Logo" style="height: 32px;">
                    <h1>PANEL CMS</h1>
                </a>
                <div class="d-flex gap-2">
                    <button class="btn btn-success btn-sm px-3" onclick="saveChanges()">
                        <i class="bi bi-cloud-check"></i> <span class="d-none d-sm-inline">KAYDET</span>
                    </button>
                    <a href="menu.html" target="_blank" class="btn btn-outline-gold btn-sm">
                        <i class="bi bi-eye"></i> <span class="d-none d-sm-inline">Sƒ∞TE</span>
                    </a>
                    <button class="btn btn-fire btn-sm" onclick="logout()">
                        <i class="bi bi-box-arrow-right"></i>
                    </button>
                </div>
            </div>
        </nav>

        <main class="admin-main">
            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"><i class="bi bi-grid-3x3-gap"></i></div>
                    <div class="stat-info">
                        <div class="num" id="statItems">0</div>
                        <div class="label">√úR√úN</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="bi bi-translate"></i></div>
                    <div class="stat-info">
                        <div class="num">5</div>
                        <div class="label">Dƒ∞L DESTEƒûƒ∞</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="bi bi-tags"></i></div>
                    <div class="stat-info">
                        <div class="num" id="statCats">0</div>
                        <div class="label">KATEGORƒ∞</div>
                    </div>
                </div>
            </div>

            <!-- Tabs -->
            <ul class="nav nav-tabs mb-4">
                <li class="nav-item">
                    <button class="nav-link active" onclick="switchSection('menu')">√úr√ºn Y√∂netimi</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" onclick="switchSection('content')">Site Metinleri</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" id="tabReviews" onclick="switchSection('reviews')">Yorum Y√∂netimi</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link text-warning" onclick="resetToDefaults()"><i
                            class="bi bi-arrow-clockwise"></i> Sƒ±fƒ±rla</button>
                </li>
            </ul>

            <!-- Sections -->
            <div id="sectionMenu">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="m-0" style="color:var(--gold)">Men√º ƒ∞√ßeriƒüi</h3>
                    <button class="btn btn-gold btn-sm px-4" onclick="showCategoryModal()">
                        <i class="bi bi-plus-lg"></i> Yeni Kategori
                    </button>
                </div>
                <div id="menuCategoryList"></div>
            </div>

            <div id="sectionContent" style="display: none;">
                <h3 class="mb-4" style="color:var(--gold)">Site Metinlerini D√ºzenle</h3>
                <div class="alert alert-info bg-dark border-secondary text-light small">
                    <i class="bi bi-info-circle me-2"></i> Bu b√∂l√ºmdeki metinler "Hakkƒ±mƒ±zda" ve Ana Sayfadaki sabit
                    alanlarƒ± y√∂netir.
                </div>
                <!-- CMS Static Content Interface here... -->
                <div id="staticContentEditor" class="cat-card p-4">
                    <p class="text-muted">Y√ºkleniyor...</p>
                </div>
            </div>

            <div id="sectionReviews" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="m-0" style="color:var(--gold)">M√º≈üteri Yorumlarƒ±</h3>
                    <button class="btn btn-gold btn-sm px-4" onclick="showReviewModal()">
                        <i class="bi bi-plus-lg"></i> Yeni Yorum Ekle
                    </button>
                </div>
                <div class="alert alert-warning bg-dark border-warning text-warning small">
                    <i class="bi bi-star-fill me-2"></i> Kural Gereƒüi: Sadece 5 yƒ±ldƒ±zlƒ± yorumlar sisteme kabul edilir.
                </div>
                <div id="adminReviewList"></div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Product Modal -->
    <div class="modal fade" id="productModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">√úr√ºn D√ºzenle</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="lang-tabs d-flex">
                        <button class="lang-tab active" data-lang="tr">TR</button>
                        <button class="lang-tab" data-lang="en">EN</button>
                        <button class="lang-tab" data-lang="ru">RU</button>
                        <button class="lang-tab" data-lang="ar">AR</button>
                        <button class="lang-tab" data-lang="de">DE</button>
                        <button class="btn btn-outline-info btn-sm ms-auto" onclick="autoTranslateProduct()"
                            title="AI ile TR'den √áevir">
                            <i class="bi bi-stars"></i>
                        </button>
                    </div>

                    <div id="productForms">
                        <!-- Repeated for each language -->
                    </div>

                    <div class="mt-3">
                        <label class="form-label">Fƒ∞YAT (‚Ç∫)</label>
                        <input type="number" class="form-control" id="prodPrice" placeholder="0">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-fire" id="prodDeleteBtn" style="display:none">Sƒ∞L</button>
                    <button class="btn btn-gold px-4" onclick="saveProduct()">DEƒûƒ∞≈ûƒ∞KLƒ∞KLERƒ∞ UYGULA</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Category Modal -->
    <div class="modal fade" id="categoryModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Kategori Y√∂netimi</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="lang-tabs d-flex">
                        <button class="lang-tab active" data-lang="tr">TR</button>
                        <button class="lang-tab" data-lang="en">EN</button>
                        <button class="lang-tab" data-lang="ru">RU</button>
                        <button class="lang-tab" data-lang="ar">AR</button>
                        <button class="lang-tab" data-lang="de">DE</button>
                    </div>
                    <div id="categoryForms"></div>
                    <div class="row g-3 mt-2">
                        <div class="col-6">
                            <label class="form-label">ƒ∞kon (Emoji)</label>
                            <input type="text" class="form-control" id="catIcon" placeholder="üçΩÔ∏è">
                        </div>
                        <div class="col-6">
                            <label class="form-label">B√ñL√úM</label>
                            <select class="form-control" id="catSection">
                                <option value="food">üç¥ Yiyecekler</option>
                                <option value="drink">üçπ ƒ∞√ßecekler</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-gold w-100" onclick="saveCategory()">KATEGORƒ∞Yƒ∞ KAYDET</button>
                </div>
            </div>
        </div>
        <!-- Review Modal -->
        <div class="modal fade" id="reviewModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Yeni Yorum Ekle</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">M√º≈üteri Adƒ±</label>
                            <input type="text" class="form-control" id="revName" placeholder="√ñrn: Ahmet Y.">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Yorum Metni</label>
                            <textarea class="form-control" id="revText" rows="4"
                                placeholder="M√º≈üterinin yorumunu buraya yapƒ±≈ütƒ±rƒ±n..."></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Tarih ƒ∞fadesi</label>
                            <input type="text" class="form-control" id="revDate" placeholder="√ñrn: 1 hafta √∂nce">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-gold w-100" onclick="addNewReview()">YORUMU EKLE</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast -->
        <div class="toast-container">
            <div id="toast" class="toast hide">
                <div class="toast-body" id="toastMsg"></div>
            </div>
        </div>

        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="js/menu-data.js"></script>
        <script src="js/reviews-data.js"></script>
        <script src="js/i18n.js"></script>

        <script src="js/auth-config.js"></script>
        <script>
            let currentMenu = null;
            let pModal, cModal;
            let editingProduct = null; // {catKey, index}
            let editingCategory = null; // catKey
            let activeLangTab = 'tr';

            document.addEventListener('DOMContentLoaded', () => {
                pModal = new bootstrap.Modal(document.getElementById('productModal'));
                cModal = new bootstrap.Modal(document.getElementById('categoryModal'));

                initTabs();
                if (sessionStorage.getItem('muhabbetAdmin') === 'authenticated') startAdmin();
            });

            document.getElementById('loginForm').addEventListener('submit', (e) => {
                e.preventDefault();
                if (document.getElementById('passwordInput').value === ADMIN_PASS) {
                    sessionStorage.setItem('muhabbetAdmin', 'authenticated');
                    startAdmin();
                } else alert('Hatalƒ± ≈ûifre!');
            });

            function startAdmin() {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                currentMenu = getMenuData();
                renderMenuContent();
                renderStaticEditor();
                updateStats();
            }

            function logout() { sessionStorage.removeItem('muhabbetAdmin'); location.reload(); }

            function updateStats() {
                let total = 0;
                Object.values(currentMenu).forEach(c => {
                    if (c.items) total += c.items.length;
                    if (c.subcategories) c.subcategories.forEach(s => total += s.items.length);
                });
                document.getElementById('statItems').innerText = total;
                document.getElementById('statCats').innerText = Object.keys(currentMenu).length;
            }

            function switchSection(sec) {
                document.getElementById('sectionMenu').style.display = sec === 'menu' ? 'block' : 'none';
                document.getElementById('sectionContent').style.display = sec === 'content' ? 'block' : 'none';
                document.getElementById('sectionReviews').style.display = sec === 'reviews' ? 'block' : 'none';

                document.querySelectorAll('.nav-tabs .nav-link').forEach(l => {
                    const text = l.innerText.toLowerCase();
                    const isActive = text.includes(sec === 'menu' ? '√ºr√ºn' : sec === 'content' ? 'site' : 'yorum');
                    l.classList.toggle('active', isActive);
                });

                if (sec === 'reviews') renderAdminReviews();
            }

            function initTabs() {
                document.querySelectorAll('.lang-tab').forEach(t => {
                    t.addEventListener('click', () => {
                        activeLangTab = t.dataset.lang;
                        document.querySelectorAll('.lang-tab').forEach(b => b.classList.toggle('active', b.dataset.lang === activeLangTab));
                        document.querySelectorAll('.lang-pane').forEach(p => p.style.display = p.dataset.lang === activeLangTab ? 'block' : 'none');
                    });
                });
            }

            function renderMenuContent() {
                const list = document.getElementById('menuCategoryList');
                list.innerHTML = '';
                Object.keys(currentMenu).forEach(key => {
                    const cat = currentMenu[key];
                    const div = document.createElement('div');
                    div.className = 'cat-card';
                    div.innerHTML = `
                    <div class="cat-card-header">
                        <div class="cat-title">${cat.icon || 'üìã'} ${cat.name.tr}</div>
                        <div class="d-flex gap-2">
                             <button class="btn btn-outline-gold btn-sm" onclick="showCategoryModal('${key}')"><i class="bi bi-pencil"></i></button>
                             <button class="btn btn-fire btn-sm" onclick="deleteCategory('${key}')"><i class="bi bi-trash"></i></button>
                             <button class="btn btn-gold btn-sm" onclick="showProductModal('${key}')"><i class="bi bi-plus"></i> √úr√ºn</button>
                        </div>
                    </div>
                    <div class="product-list">
                        ${cat.items ? cat.items.map((it, idx) => `
                            <div class="product-row" onclick="showProductModal('${key}', ${idx})">
                                <div class="product-info">
                                    <span class="product-name">${it.name.tr}</span>
                                    <span class="product-desc">${it.description?.tr || 'A√ßƒ±klama yok...'}</span>
                                </div>
                                <div class="product-price">${it.price}‚Ç∫</div>
                            </div>
                        `).join('') : ''}
                        
                        ${cat.subcategories ? cat.subcategories.map((sub, sIdx) => `
                            <div class="section-divider small text-muted mt-3 mb-2 px-2 d-flex align-items-center gap-2">
                                <span class="fw-bold">${typeof sub.name === 'object' ? sub.name.tr : sub.name}</span>
                                <div class="flex-grow-1 border-bottom border-secondary opacity-25"></div>
                                <button class="btn btn-gold btn-sm py-0 px-2" onclick="showProductModal('${key}', null, ${sIdx})">+</button>
                            </div>
                            ${sub.items.map((it, idx) => `
                                <div class="product-row" onclick="showProductModal('${key}', ${idx}, ${sIdx})">
                                    <div class="product-info">
                                        <span class="product-name">${it.name.tr}</span>
                                        <span class="product-desc">${it.description?.tr || ''}</span>
                                    </div>
                                    <div class="product-price">${it.price}‚Ç∫</div>
                                </div>
                            `).join('')}
                        `).join('') : ''}
                    </div>
                `;
                    list.appendChild(div);
                });
            }

            // --- Product Modal Logic ---
            function showProductModal(catKey, index = null, subIndex = null) {
                editingProduct = { catKey, index, subIndex };
                const container = document.getElementById('productForms');
                container.innerHTML = '';

                const languages = ['tr', 'en', 'ru', 'ar', 'de'];
                let item = null;
                if (index !== null) {
                    item = (subIndex !== null)
                        ? currentMenu[catKey].subcategories[subIndex].items[index]
                        : currentMenu[catKey].items[index];
                }

                languages.forEach(lang => {
                    const div = document.createElement('div');
                    div.className = 'lang-pane';
                    div.dataset.lang = lang;
                    div.style.display = lang === activeLangTab ? 'block' : 'none';
                    div.innerHTML = `
                    <div class="mb-3">
                        <label class="form-label">${lang.toUpperCase()} ADI</label>
                        <input type="text" class="form-control" id="pName_${lang}" value="${item ? (item.name[lang] || '') : ''}">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">${lang.toUpperCase()} A√áIKLAMA</label>
                        <textarea class="form-control" id="pDesc_${lang}" rows="2">${item ? (item.description?.[lang] || '') : ''}</textarea>
                    </div>
                `;
                    container.appendChild(div);
                });

                document.getElementById('prodPrice').value = item ? item.price : '';
                document.getElementById('prodDeleteBtn').style.display = index !== null ? 'block' : 'none';
                document.getElementById('prodDeleteBtn').onclick = deleteProduct;
                pModal.show();
            }

            function saveProduct() {
                const { catKey, index, subIndex } = editingProduct;
                const item = { name: {}, description: {}, price: parseInt(document.getElementById('prodPrice').value) };

                ['tr', 'en', 'ru', 'ar', 'de'].forEach(l => {
                    item.name[l] = document.getElementById(`pName_${l}`).value || document.getElementById(`pName_tr`).value;
                    item.description[l] = document.getElementById(`pDesc_${l}`).value;
                });

                if (index !== null) {
                    if (subIndex !== null) currentMenu[catKey].subcategories[subIndex].items[index] = item;
                    else currentMenu[catKey].items[index] = item;
                } else {
                    if (subIndex !== null) currentMenu[catKey].subcategories[subIndex].items.push(item);
                    else currentMenu[catKey].items.push(item);
                }

                pModal.hide();
                renderMenuContent();
                updateStats();
                notify('ƒ∞≈ülem tamamlandƒ±.');
            }

            function deleteProduct() {
                const { catKey, index, subIndex } = editingProduct;
                if (confirm('Siliyorsunuz, emin misiniz?')) {
                    if (subIndex !== null) currentMenu[catKey].subcategories[subIndex].items.splice(index, 1);
                    else currentMenu[catKey].items.splice(index, 1);

                    pModal.hide();
                    renderMenuContent();
                    updateStats();
                }
            }

            // --- Category Modal Logic ---
            function showCategoryModal(key = null) {
                editingCategory = key;
                const container = document.getElementById('categoryForms');
                container.innerHTML = '';
                const cat = key ? currentMenu[key] : null;

                ['tr', 'en', 'ru', 'ar', 'de'].forEach(lang => {
                    const div = document.createElement('div');
                    div.className = 'lang-pane';
                    div.dataset.lang = lang;
                    div.style.display = lang === activeLangTab ? 'block' : 'none';
                    div.innerHTML = `
                    <div class="mb-2">
                        <label class="form-label">${lang.toUpperCase()} KATEGORƒ∞ ADI</label>
                        <input type="text" class="form-control" id="cName_${lang}" value="${cat ? (cat.name[lang] || '') : ''}">
                    </div>
                `;
                    container.appendChild(div);
                });

                document.getElementById('catIcon').value = cat ? cat.icon : 'üçΩÔ∏è';
                document.getElementById('catSection').value = cat ? cat.section : 'food';
                cModal.show();
            }

            function saveCategory() {
                const key = editingCategory || 'cat_' + Date.now();
                const cat = currentMenu[key] || { key, items: [], section: 'food', name: {} };

                ['tr', 'en', 'ru', 'ar', 'de'].forEach(l => {
                    cat.name[l] = document.getElementById(`cName_${l}`).value;
                });
                cat.icon = document.getElementById('catIcon').value;
                cat.section = document.getElementById('catSection').value;

                currentMenu[key] = cat;
                cModal.hide();
                renderMenuContent();
                notify('Kategori g√ºncellendi.');
            }

            function deleteCategory(key) {
                if (confirm('Siliyorsunuz, emin misiniz?')) {
                    delete currentMenu[key];
                    renderMenuContent();
                    updateStats();
                }
            }

            // --- CMS Static Content Logic ---
            function renderStaticEditor() {
                const container = document.getElementById('staticContentEditor');
                let html = `
                <div class="lang-tabs d-flex">
                    <button class="lang-tab active" data-lang="tr" onclick="setStaticLang('tr')">TR</button>
                    <button class="lang-tab" data-lang="en" onclick="setStaticLang('en')">EN</button>
                    <button class="lang-tab" data-lang="ru" onclick="setStaticLang('ru')">RU</button>
                    <button class="lang-tab" data-lang="ar" onclick="setStaticLang('ar')">AR</button>
                    <button class="lang-tab" data-lang="de" onclick="setStaticLang('de')">DE</button>
                </div>
            `;

                ['tr', 'en', 'ru', 'ar', 'de'].forEach(l => {
                    const tr = translations[l];
                    html += `
                    <div class="static-pane" data-slang="${l}" style="display:${l === 'tr' ? 'block' : 'none'}">
                        <div class="mb-3">
                            <label class="form-label">Ana Ba≈ülƒ±k 1 (Arap√ßa gibi dillerde hizalamaya dikkat)</label>
                            <input type="text" class="form-control" onchange="updateStatic('${l}', 'hero_title_1', this.value)" value="${tr.hero_title_1}">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Hero Alt Ba≈ülƒ±k</label>
                            <textarea class="form-control" rows="3" onchange="updateStatic('${l}', 'hero_subtitle', this.value)">${tr.hero_subtitle}</textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Hakkƒ±mƒ±zda Yazƒ±sƒ±</label>
                            <textarea class="form-control" rows="5" onchange="updateStatic('${l}', 'about_text', this.value)">${tr.about_text}</textarea>
                        </div>
                    </div>
                `;
                });
                container.innerHTML = html;
            }

            function setStaticLang(l) {
                document.querySelectorAll('.static-pane').forEach(p => p.style.display = p.dataset.slang === l ? 'block' : 'none');
                document.querySelectorAll('#staticContentEditor .lang-tab').forEach(b => b.classList.toggle('active', b.innerText === l.toUpperCase()));
            }

            function updateStatic(lang, key, val) { translations[lang][key] = val; }

            function saveChanges() {
                saveMenuData(currentMenu);
                notify('T√úM DEƒûƒ∞≈ûƒ∞KLƒ∞KLER BULUTA (LOCALSTORAGE) KAYDEDƒ∞LDƒ∞!');
            }

            function resetToDefaults() {
                if (confirm('BU ƒ∞≈ûLEM T√úM KATEGORƒ∞ VE Fƒ∞YATLARI SIFIRLAR. EMƒ∞N Mƒ∞Sƒ∞Nƒ∞Z?')) {
                    currentMenu = resetMenuData();
                    renderMenuContent();
                    updateStats();
                }
            }

            function notify(m) {
                document.getElementById('toastMsg').innerText = m;
                new bootstrap.Toast(document.getElementById('toast')).show();
            }

            function autoTranslateProduct() {
                const trName = document.getElementById('pName_tr').value;
                const trDesc = document.getElementById('pDesc_tr').value;
                if (!trName) return;

                ['en', 'ru', 'ar', 'de'].forEach(l => {
                    document.getElementById(`pName_${l}`).value = trName + ' (' + l.toUpperCase() + ')';
                    document.getElementById(`pDesc_${l}`).value = AIDescriptionProvider.generate(trName, l);
                });
                notify('AI √áeviri ve A√ßƒ±klamalar Tamamlandƒ±!');
            }
            // --- Review Management Logic ---
            let currentReviews = [];
            let rModal;

            function renderAdminReviews() {
                currentReviews = getReviews();
                const list = document.getElementById('adminReviewList');
                list.innerHTML = '';

                currentReviews.forEach((rev, idx) => {
                    const div = document.createElement('div');
                    div.className = 'product-row';
                    div.innerHTML = `
                    <div class="product-info">
                        <span class="product-name">${rev.name} <span class="text-warning">(${'‚òÖ'.repeat(rev.rating)})</span></span>
                        <span class="product-desc italic text-muted">"${rev.text}"</span>
                        <span class="product-desc small opacity-50">${rev.date}</span>
                    </div>
                    <button class="btn btn-fire btn-sm" onclick="removeReview(${idx})"><i class="bi bi-trash"></i></button>
                `;
                    list.appendChild(div);
                });
            }

            function showReviewModal() {
                rModal = new bootstrap.Modal(document.getElementById('reviewModal'));
                rModal.show();
            }

            function addNewReview() {
                const name = document.getElementById('revName').value;
                const text = document.getElementById('revText').value;
                const date = document.getElementById('revDate').value;

                if (!name || !text) return notify('L√ºtfen t√ºm alanlarƒ± doldurun.');

                currentReviews.push({ name, text, date: date || 'Bug√ºn', rating: 5 });
                saveReviews(currentReviews);
                rModal.hide();
                renderAdminReviews();
                notify('Yorum eklendi.');
            }

            function removeReview(idx) {
                if (confirm('Bu yorumu silmek istediƒüinize emin misiniz?')) {
                    currentReviews.splice(idx, 1);
                    saveReviews(currentReviews);
                    renderAdminReviews();
                    notify('Yorum silindi.');
                }
            }
        </script>
</body>

</html>